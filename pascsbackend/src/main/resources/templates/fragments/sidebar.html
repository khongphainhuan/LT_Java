<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="sidebar">
  <aside class="d-flex flex-column p-3 text-white"
    style="width:240px; background: linear-gradient(180deg,#0d6efd,#0b5ed7); min-height:100vh;">
    <div class="mb-4">
      <div class="fs-5 fw-bold" id="sidebarTitle">Cán bộ - PASCS</div>
      <div class="small text-white-50" id="sidebarSubtitle">Quản lý hồ sơ & hàng đợi</div>
    </div>

    <ul class="nav nav-pills flex-column mb-auto">
      <li class="nav-item mb-1">
        <a href="#" id="linkDashboard" class="nav-link text-white">
          <i class="fas fa-tachometer-alt me-2"></i> Dashboard
        </a>
      </li>
      <li class="nav-item mb-1">
        <a href="#" id="linkQueue" class="nav-link text-white">
          <i class="fas fa-list-ol me-2"></i> Hàng đợi
        </a>
      </li>
      <li class="nav-item mb-1">
        <a href="#" id="linkApplications" class="nav-link text-white">
          <i class="fas fa-folder-open me-2"></i> Hồ sơ
        </a>
      </li>
      <li class="nav-item mb-1">
        <a href="#" id="linkFeedback" class="nav-link text-white">
          <i class="fas fa-comment-alt me-2"></i> Phản hồi
        </a>
      </li>
      <li class="nav-item mt-3" id="itemAdmin">
        <a href="/admin/dashboard" class="nav-link text-warning">
          <i class="fas fa-cog me-2"></i> Admin
        </a>
      </li>
    </ul>

    <div class="mt-auto small text-white-50">
      <div>Phiên bản: <b>1.0</b></div>
      <div class="mt-2">© 2025 PASCS</div>
    </div>
  </aside>

  <script>
    // Update sidebar based on user role
    document.addEventListener('DOMContentLoaded', function () {
      const user = JSON.parse(localStorage.getItem('user') || '{}');
      const role = user.role;

      const linkDashboard = document.getElementById('linkDashboard');
      const linkQueue = document.getElementById('linkQueue');
      const linkApplications = document.getElementById('linkApplications');
      const linkFeedback = document.getElementById('linkFeedback');
      const itemAdmin = document.getElementById('itemAdmin');

      if (role === 'ADMIN' || role === 'ROLE_ADMIN') {
        document.getElementById('sidebarTitle').textContent = 'Quản trị - PASCS';
        document.getElementById('sidebarSubtitle').textContent = 'Quản trị hệ thống';

        linkDashboard.href = '/admin/dashboard';
        linkQueue.href = '/staff/queue'; // Admin can view staff queue
        linkApplications.href = '/staff/applications'; // Admin can view applications
        linkFeedback.href = '/admin/feedback';
        itemAdmin.style.display = 'none';
      } else if (role === 'STAFF' || role === 'ROLE_STAFF') {
        document.getElementById('sidebarTitle').textContent = 'Cán bộ - PASCS';
        document.getElementById('sidebarSubtitle').textContent = 'Quản lý hồ sơ & hàng đợi';

        linkDashboard.href = '/staff/dashboard';
        linkQueue.href = '/staff/queue';
        linkApplications.href = '/staff/applications';
        linkFeedback.parentElement.style.display = 'none'; // Staff doesn't have feedback page yet
        itemAdmin.style.display = 'none';
      } else {
        document.getElementById('sidebarTitle').textContent = 'Công dân - PASCS';
        document.getElementById('sidebarSubtitle').textContent = 'Cổng dịch vụ công';

        linkDashboard.href = '/citizen/dashboard';
        linkQueue.href = '/citizen/take-number';
        linkApplications.href = '/citizen/my-applications';
        linkFeedback.parentElement.style.display = 'none'; // Citizen feedback not implemented in sidebar yet
        itemAdmin.style.display = 'none';
      }
    });
  </script>
</div>

</html>