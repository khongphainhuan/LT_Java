<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="header">
  <header class="d-flex align-items-center justify-content-between px-4 py-2 bg-white shadow-sm sticky-top">
    <!-- Logo & Tên hệ thống -->
    <div class="d-flex align-items-center gap-3">
      <a href="dashboard.html">
        <img src="images/logo.png" alt="PASCS" style="height:48px; border-radius:8px;">
      </a>
      <div class="d-flex flex-column">
        <span class="fw-bold text-primary fs-5">PASCS</span>
        <small class="text-muted">Public Administrative Service --- Commune / Ward</small>
      </div>
    </div>

    <!-- Người dùng & menu -->
    <div class="d-flex align-items-center gap-3">
      <div class="d-none d-md-block text-muted small">
        Vai trò: <span class="fw-semibold" id="userRole">Cán bộ</span>
      </div>
      <div class="dropdown">
        <a class="d-flex align-items-center btn btn-sm btn-outline-primary rounded-pill dropdown-toggle" href="#"
          role="button" id="userMenu" data-bs-toggle="dropdown" aria-expanded="false">
          <i class="fas fa-user-circle fs-5 me-2"></i>
          <span id="userName">Cán bộ A</span>
        </a>
        <ul class="dropdown-menu dropdown-menu-end shadow-lg border-0 rounded-4 p-2">
          <li>
            <div class="px-3 py-2">
              <div class="fw-bold text-dark" id="menuUserName">User</div>
              <div class="small text-muted" id="menuUserRole">Role</div>
            </div>
          </li>
          <li>
            <hr class="dropdown-divider my-2">
          </li>
          <li><a class="dropdown-item rounded-3 py-2 mb-1 d-flex align-items-center gap-2" th:href="@{/citizen/profile}"
              onclick="window.location.href='/citizen/profile'; return false;">
              <i class="fas fa-user text-primary me-2" style="width: 20px;"></i> Hồ sơ cá nhân
            </a></li>
          <li><a class="dropdown-item rounded-3 py-2 d-flex align-items-center gap-2" href="/citizen/dashboard">
              <i class="fas fa-home text-primary me-2" style="width: 20px;"></i> Trang chủ
            </a></li>
          <li>
            <hr class="dropdown-divider my-2">
          </li>
          <li><a class="dropdown-item rounded-3 py-2 text-danger d-flex align-items-center gap-2 bg-soft-danger"
              href="#" onclick="logout()">
              <i class="fas fa-sign-out-alt me-2" style="width: 20px;"></i> Đăng xuất
            </a></li>
        </ul>
      </div>
    </div>
  </header>

  <style>
    .bg-soft-danger {
      background-color: rgba(220, 53, 69, 0.1);
      color: #dc3545;
    }

    .bg-soft-danger:hover {
      background-color: rgba(220, 53, 69, 0.2);
      color: #b02a37;
    }
  </style>

  <script>
    function logout() {
      localStorage.removeItem('token');
      localStorage.removeItem('user');
      window.location.href = 'login.html';
    }

    // Load user info
    document.addEventListener('DOMContentLoaded', function () {
      const user = JSON.parse(localStorage.getItem('user') || '{}');
      if (user.username) {
        document.getElementById('userName').textContent = user.fullName || user.username;
        document.getElementById('userRole').textContent = user.role || 'Cán bộ';

        // Populate menu info
        const menuName = document.getElementById('menuUserName');
        const menuRole = document.getElementById('menuUserRole');
        if (menuName) menuName.textContent = user.fullName || user.username;
        if (menuRole) menuRole.textContent = user.role || 'Cán bộ';
      }
    });
  </script>
</div>

</html>