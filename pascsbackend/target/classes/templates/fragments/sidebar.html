<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="sidebar">
  <aside class="d-flex flex-column p-3 text-white"
    style="width:240px; background: linear-gradient(180deg,#0d6efd,#0b5ed7); min-height:100vh;">
    <div class="mb-4">
      <div class="fs-5 fw-bold" id="sidebarTitle">Cán bộ - PASCS</div>
      <div class="small text-white-50" id="sidebarSubtitle">Quản lý hồ sơ & hàng đợi</div>
    </div>

    <ul class="nav nav-pills flex-column mb-auto">
      <li class="nav-item mb-1">
        <a href="#" id="linkDashboard" class="nav-link text-white">
          <i class="fas fa-tachometer-alt me-2"></i> Dashboard
        </a>
      </li>

      <!-- Staff/Citizen Links -->
      <li class="nav-item mb-1" id="itemQueue">
        <a href="#" id="linkQueue" class="nav-link text-white">
          <i class="fas fa-list-ol me-2"></i> Hàng đợi
        </a>
      </li>
      <li class="nav-item mb-1" id="itemApplications">
        <a href="#" id="linkApplications" class="nav-link text-white">
          <i class="fas fa-folder-open me-2"></i> Hồ sơ
        </a>
      </li>

      <!-- Admin Links -->
      <li class="nav-item mb-1" id="itemUsers" style="display: none;">
        <a href="/admin/users" class="nav-link text-white">
          <i class="fas fa-users me-2"></i> Người dùng
        </a>
      </li>
      <li class="nav-item mb-1" id="itemServices" style="display: none;">
        <a href="/admin/services" class="nav-link text-white">
          <i class="fas fa-concierge-bell me-2"></i> Dịch vụ
        </a>
      </li>
      <li class="nav-item mb-1" id="itemReports" style="display: none;">
        <a href="/admin/reports" class="nav-link text-white">
          <i class="fas fa-chart-bar me-2"></i> Báo cáo
        </a>
      </li>

      <!-- Shared/Common Links -->
      <li class="nav-item mb-1" id="itemFeedback">
        <a href="#" id="linkFeedback" class="nav-link text-white">
          <i class="fas fa-comment-alt me-2"></i> Phản hồi
        </a>
      </li>
      <li class="nav-item mb-1" id="itemSettings" style="display: none;">
        <a href="/admin/settings" class="nav-link text-white">
          <i class="fas fa-cog me-2"></i> Cấu hình
        </a>
      </li>
    </ul>

    <div class="mt-auto small text-white-50">
      <div>Phiên bản: <b>1.0</b></div>
      <div class="mt-2">© 2025 PASCS</div>
    </div>
  </aside>

  <script>
    // Update sidebar based on user role
    document.addEventListener('DOMContentLoaded', function () {
      const user = JSON.parse(localStorage.getItem('user') || '{}');
      const role = user.role;

      const linkDashboard = document.getElementById('linkDashboard');
      const itemQueue = document.getElementById('itemQueue');
      const linkQueue = document.getElementById('linkQueue');
      const itemApplications = document.getElementById('itemApplications');
      const linkApplications = document.getElementById('linkApplications');
      const itemFeedback = document.getElementById('itemFeedback');
      const linkFeedback = document.getElementById('linkFeedback');

      // Admin items
      const itemUsers = document.getElementById('itemUsers');
      const itemServices = document.getElementById('itemServices');
      const itemReports = document.getElementById('itemReports');
      const itemSettings = document.getElementById('itemSettings');

      if (role === 'ADMIN' || role === 'ROLE_ADMIN') {
        document.getElementById('sidebarTitle').textContent = 'Quản trị - PASCS';
        document.getElementById('sidebarSubtitle').textContent = 'Quản trị hệ thống';

        linkDashboard.href = '/admin/dashboard';

        // Hide Staff/Citizen specific items
        itemQueue.style.display = 'none';
        itemApplications.style.display = 'none';

        // Show Admin items
        itemUsers.style.display = 'block';
        itemServices.style.display = 'block';
        itemReports.style.display = 'block';
        itemSettings.style.display = 'block';

        linkFeedback.href = '/admin/feedback';
      } else if (role === 'STAFF' || role === 'ROLE_STAFF') {
        document.getElementById('sidebarTitle').textContent = 'Cán bộ - PASCS';
        document.getElementById('sidebarSubtitle').textContent = 'Quản lý hồ sơ & hàng đợi';

        linkDashboard.href = '/staff/dashboard';
        linkQueue.href = '/staff/queue';
        linkApplications.href = '/staff/applications';

        linkFeedback.href = '/staff/feedback';
      } else {
        document.getElementById('sidebarTitle').textContent = 'Công dân - PASCS';
        document.getElementById('sidebarSubtitle').textContent = 'Cổng dịch vụ công';

        linkDashboard.href = '/citizen/dashboard';
        linkQueue.href = '/citizen/take-number';
        linkApplications.href = '/citizen/my-applications';

        linkFeedback.href = '/citizen/feedback';
      }
    });
  </script>
</div>

</html>